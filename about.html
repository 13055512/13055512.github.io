---
layout: default
title: (๑•́ ₃ •̀๑)
---
    
<div class="container">
      <h2 id="-">写在前面</h2>
<h3 id="-model-"><strong>Model：数据</strong></h3>
<p>用于封装业务逻辑相关的数据以及对数据的处理方法。
本身是完全独立的个体，并且应该能被监听到执行的结果。M 层不应该知道 View 的存在。</p>
<p>最直接的例子就是网络请求，网络请求时完全独立于视图层的，而且做的事情也很单一，
可以很好地复用。</p>
<h3 id="-controller-"><strong>Controller：控制层</strong></h3>
<p>用于连接 Model 层和 View 层。主要接收来自 View 的交互信号和 Model 的改变结果，
然后做相应的操作。</p>
<p>Adapter 应该属于这一层。因为 Adapter 中会做到很多数据的处理，比如根据数据类型选择 Item
这样的操作。而这样的操作如果放入 View 层，就会让 View 层一下子失去复用的能力。
控制层应该是最不容易复用的。</p>
<h3 id="-view-"><strong>View：视图</strong></h3>
<p>独立于数据，里面没有什么业务逻辑，仅仅是做展现。
Android 中的 View，比如 TextView，Button 等都属于此类。</p>
<p>至于 Activity、Fragment 算不算这层的东西呢？它们貌似都处于灰色地带，很难得到明确的定义。
相比传统的思路，其实可以认为 Activity 和 Fragment 是可以属于 V 层的。</p>
<h2 id="mvc">MVC</h2>
<p>Model/View/Controller<br>如果我们让 Activity 做 View 和 Model 的绑定操作，那么会让 Activity 越来越臃肿。
我们应该思考以下这些问题：</p>
<ol>
<li>activity该做view的绑定工作么？</li>
<li>activity要做view的动画操作么？</li>
<li>activity应处理从网络返回的结果么？</li>
<li>activity需要做不同状态下view的状态的控制么？</li>
</ol>
<h2 id="mvp">MVP</h2>
<p>算是对 MVC 的一个升级，产生了清晰的分层。此时 Activity 和 XML 视为 View 层。<br>View 操作 P 层，P 层会去调用 Model 执行操作，P 中接收到结果后去调用 V 层来更新界面。<br>例子：</p>
<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span>presenter&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="keyword control new java"><span>new</span></span><span>&nbsp;</span><span class="storage type java"><span>AppInfoPresenter</span></span><span>(</span><span>)</span><span class="punctuation terminator java"><span>;</span></span><span>&nbsp;</span><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;p层</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source java"><span>mShowPackageNameBtn</span><span class="keyword operator dereference java"><span>.</span></span><span class="meta method-call java"><span class="meta method java"><span>setOnClickListener</span></span><span class="punctuation definition method-parameters begin java"><span>(</span></span><span>v&nbsp;</span><span class="storage type function arrow java"><span>-&gt;</span></span><span>&nbsp;</span><span class="punctuation section block begin java"><span>{</span></span></span></span></div><div class="line"><span class="source java"><span class="meta method-call java"><span>&nbsp;&nbsp;&nbsp;&nbsp;v</span><span class="keyword operator dereference java"><span>.</span></span><span class="meta method-call java"><span class="meta method java"><span>setEnabled</span></span><span class="punctuation definition method-parameters begin java"><span>(</span></span><span class="constant language java"><span>false</span></span><span class="punctuation definition method-parameters end java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span><span>&nbsp;</span><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;activity变成v层，这里控制view的相关状态</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source java"><span class="meta method-call java"><span class="punctuation whitespace comment leading java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;点击后的事情交给p做，p做完后应该给v一个回调。为了说明简单，这里是同步回调。</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source java"><span class="meta method-call java"><span>&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;name&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;presenter</span><span class="keyword operator dereference java"><span>.</span></span><span class="meta method-call java"><span class="meta method java"><span>getPackageInfo</span></span><span class="punctuation definition method-parameters begin java"><span>(</span></span><span class="meta method-call java"><span class="meta method java"><span>getApplication</span></span><span class="punctuation definition method-parameters begin java"><span>(</span></span><span class="punctuation definition method-parameters end java"><span>)</span></span></span><span class="punctuation definition method-parameters end java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span><span>&nbsp;</span><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;p层将最终的结果交给v层</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source java"><span class="meta method-call java"><span>&nbsp;&nbsp;&nbsp;&nbsp;mShowPackageNameBtn</span><span class="keyword operator dereference java"><span>.</span></span><span class="meta method-call java"><span class="meta method java"><span>setText</span></span><span class="punctuation definition method-parameters begin java"><span>(</span></span><span>name</span><span class="punctuation definition method-parameters end java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span><span>&nbsp;</span><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;得到回调后更新视图</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source java"><span class="meta method-call java"><span class="punctuation section block end java"><span>}</span></span><span class="punctuation definition method-parameters end java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div></pre>
<p>内层对外层不知情的好处是内层可以随意地做复用，坏处就是需要建立相互通信的机制，会带来各种
回调。当然，你可以用 Rx 的方式很简单地做回调。
但当事件复杂后，就可以看出 MVP 中一个很蛋疼的后遗症————各种回调。而这些回调都是要根据不
同页面写的，而每写一个回调就要写一个接口，接口的参数也要根据需求变。
要是想弄得简单一点，第一种方式：可以让 P 和 V 层互相知道对方的存在。但这会造成 P 的复用性丧失。<br>另一种方式：让 P 中包含 V 的对象，可以不用写任何回调就能直接触发 V 的方法。但如果这个 V
被复用，就要改一改了。这种方案的缺点是灵活性不够。<br>MVP 的优点：</p>
<ol>
<li>当 Activity意外重启时 P 层不会被重启。</li>
<li>Activity 重启时， P 层和 Activity 会重新绑定，根据数据恢复 Activity 的状态。</li>
<li>而当 Activity 真正的销毁时，对应的 P 层也会随之销毁。</li>
</ol>
<h2 id="mvvm">MVVM</h2>
<p>可以算是 MVP 的升级版，即 Model/View/ViewModel，View 和 ViewModel 之间的交互通过 Data Binding 完成。<br><em>Model 层</em>：<br>是很多具体类的聚合，主要做与展示无关的业务逻辑。要实现一个页面的需求，我们可能会用到很多
类，包括工具类和各种库。这些类都提供了一个或多个功能，我们利用这些功能便可最终实现需求。</p>
<p><em>View 层</em>：<br>具体的 View，Activity，Fragment 等，做 UI 展示/逻辑/动画。</p>
<p><em>ViewModel 层</em>：<br>由插件自动生成的具体类，是 View 展示的数据的 Java 抽象，仅能被 Model 层直接操作。</p>
<h3 id="-mvvm-">理想化的 MVVM 最好是只用写少量代码就能完成具体需求的东西。</h3>
<p>以前的做法：<br>建立 XML，在 Activity 中找到 View，创建数据模型，写好网络回调，回调成功后一次设置 View 的状态。<br>理想化的做法：
写好数据模型，建立 XML 时直接绑定数据模型，在 Activity 中写好回调就行。
举个栗子：<br>数据模型：</p>
<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="meta class java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta class identifier java"><span class="storage modifier java"><span>class</span></span><span>&nbsp;</span><span class="entity name type class java"><span>UserInfo</span></span></span><span>&nbsp;</span><span class="meta definition class inherited classes java"><span class="storage modifier extends java"><span>extends</span></span><span>&nbsp;</span><span class="entity other inherited-class java"><span>BaseObservable</span></span><span>&nbsp;</span></span><span class="meta class body java"><span class="punctuation section class begin java"><span>{</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier java"><span>private</span></span><span>&nbsp;</span><span class="storage type java"><span>String</span></span><span>&nbsp;name</span><span class="punctuation terminator java"><span>;</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type annotation java"><span>@Bindable</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta method return-type java"><span class="storage type java"><span>String</span></span><span>&nbsp;</span></span><span class="meta method identifier java"><span class="entity name function java"><span>getName</span></span><span>(</span><span>)</span></span><span>&nbsp;</span><span class="punctuation section method begin java"><span>{</span></span><span class="meta method body java"><span>&nbsp;</span><span class="keyword control java"><span>return</span></span><span>&nbsp;name</span><span class="punctuation terminator java"><span>;</span></span><span>&nbsp;</span></span><span class="punctuation section method end java"><span>}</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta method return-type java"><span class="storage type primitive array java"><span>void</span></span><span>&nbsp;</span></span><span class="meta method identifier java"><span class="entity name function java"><span>setName</span></span><span>(</span><span class="storage type java"><span>String</span></span><span>&nbsp;</span><span class="variable parameter java"><span>name</span></span><span>)</span></span><span>&nbsp;</span><span class="punctuation section method begin java"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable language this java"><span>this</span></span><span class="keyword operator dereference java"><span>.</span></span><span>name&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;name</span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method-call java"><span class="meta method java"><span>notifyPropertyChanged</span></span><span class="punctuation definition method-parameters begin java"><span>(</span></span><span class="storage type java"><span>com.kale.dream</span><span class="keyword operator dereference java"><span>.</span></span><span>BR</span></span><span class="keyword operator dereference java"><span>.</span></span><span>name</span><span class="punctuation definition method-parameters end java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation section method end java"><span>}</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="punctuation section class end java"><span>}</span></span></span></span></div></pre>
<p>布局文件：</p>
<pre class="editor-colors lang-XML"><div class="line"><span class="text plain null-grammar"><span>&lt;layout&nbsp;xmlns:android=&quot;</span><span class="markup underline link http hyperlink"><span>http://schemas.android.com/apk/res/android</span></span><span>&quot;&gt;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;data&gt;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;variable&nbsp;name=&quot;user&quot;&nbsp;type=&quot;com.kale.dream.UserInfo&quot;/&gt;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/data&gt;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;TextView</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;android:layout_width=&quot;wrap_content&quot;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;android:layout_height=&quot;wrap_content&quot;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;android:text=&quot;@{user.name}&quot;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&gt;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&lt;/layout&gt;</span></span></div></pre>
<p>Activity：</p>
<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="meta class java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta class identifier java"><span class="storage modifier java"><span>class</span></span><span>&nbsp;</span><span class="entity name type class java"><span>example</span></span></span><span>&nbsp;</span><span class="meta definition class inherited classes java"><span class="storage modifier extends java"><span>extends</span></span><span>&nbsp;</span><span class="entity other inherited-class java"><span>AppCompatActivity</span></span><span>&nbsp;</span></span><span class="meta class body java"><span class="punctuation section class begin java"><span>{</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type annotation java"><span>@Override</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method java"><span class="storage modifier java"><span>protected</span></span><span>&nbsp;</span><span class="meta method return-type java"><span class="storage type primitive array java"><span>void</span></span><span>&nbsp;</span></span><span class="meta method identifier java"><span class="entity name function java"><span>onCreate</span></span><span>(</span><span class="storage type java"><span>Bundle</span></span><span>&nbsp;</span><span class="variable parameter java"><span>savedInstanceState</span></span><span>)</span></span><span>&nbsp;</span><span class="punctuation section method begin java"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable language java"><span>super</span></span><span class="keyword operator dereference java"><span>.</span></span><span class="meta method-call java"><span class="meta method java"><span>onCreate</span></span><span class="punctuation definition method-parameters begin java"><span>(</span></span><span>savedInstanceState</span><span class="punctuation definition method-parameters end java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier java"><span>final</span></span><span>&nbsp;</span><span class="storage type java"><span>Dream01Binding</span></span><span>&nbsp;binding&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="storage type java"><span>DataBindingUtil</span></span><span class="keyword operator dereference java"><span>.</span></span><span class="meta method-call java"><span class="meta method java"><span>setContentView</span></span><span class="punctuation definition method-parameters begin java"><span>(</span></span><span class="variable language this java"><span>this</span></span><span class="punctuation definition seperator parameter java"><span>,</span></span><span>&nbsp;</span><span class="storage type java"><span>R</span></span><span class="keyword operator dereference java"><span>.</span></span><span>layout</span><span class="keyword operator dereference java"><span>.</span></span><span>dream_01</span><span class="punctuation definition method-parameters end java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type java"><span>HttpUtil</span></span><span class="keyword operator dereference java"><span>.</span></span><span class="meta method-call java"><span class="meta method java"><span>doGet</span></span><span class="punctuation definition method-parameters begin java"><span>(</span></span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span class="markup underline link http hyperlink"><span>http://www.xxxxxx</span></span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="punctuation definition seperator parameter java"><span>,</span></span><span>&nbsp;</span><span class="keyword control new java"><span>new</span></span><span>&nbsp;</span><span class="storage type java"><span>HttpUtil</span></span><span>.</span><span class="storage type java"><span>HttpCallback</span></span><span>(</span><span>)</span><span>&nbsp;</span><span class="meta inner-class java"><span class="punctuation section inner-class begin java"><span>{</span></span></span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span class="meta method-call java"><span class="meta inner-class java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type annotation java"><span>@Override</span></span></span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span class="meta method-call java"><span class="meta inner-class java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta method return-type java"><span class="storage type primitive array java"><span>void</span></span><span>&nbsp;</span></span><span class="meta method identifier java"><span class="entity name function java"><span>onSuccess</span></span><span>(</span><span class="storage type java"><span>UserInfo</span></span><span>&nbsp;</span><span class="variable parameter java"><span>info</span></span><span>)</span></span><span>&nbsp;</span><span class="punctuation section method begin java"><span>{</span></span></span></span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span class="meta method-call java"><span class="meta inner-class java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binding</span><span class="keyword operator dereference java"><span>.</span></span><span class="meta method-call java"><span class="meta method java"><span>setUser</span></span><span class="punctuation definition method-parameters begin java"><span>(</span></span><span>info</span><span class="punctuation definition method-parameters end java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span class="meta method-call java"><span class="meta inner-class java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation section method end java"><span>}</span></span></span></span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span class="meta method-call java"><span class="meta inner-class java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section inner-class end java"><span>}</span></span></span><span class="punctuation definition method-parameters end java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation section method end java"><span>}</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="punctuation section class end java"><span>}</span></span></span></span></div></pre>
<p>理想很丰满，现实很骨感。当我们需要处理的需求增加多时，Model 中的操作将变得越来越多，为了
解决这个问题，有些需求可以直接在 XML 中实现，当然并不是所有的需求都能在 XML 中实现，
比如动画，而且 XML 是有复用价值的。</p>
<h3 id="-mvvm">现实的 MVVM</h3>
<p>我们不希望一个框架对现有的项目结构做太多的影响，框架影响到用于 JSON 解析的 Model 是不能
容忍的。这样的话，我们需要建立一个给框架用的数据对象，所以 VM 现在就变成一个和前面的 JSON
的 Model 无关的独立类。需要注意的是：<br>VM 仅仅处理和视图展现内容有关的逻辑，比如对显示的内容作格式化这样的事情。除此之外不应处理
其他的视图逻辑。<br>数据模型：</p>
<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="meta class java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta class identifier java"><span class="storage modifier java"><span>class</span></span><span>&nbsp;</span><span class="entity name type class java"><span>UserInfo</span></span></span><span>&nbsp;</span><span class="meta class body java"><span class="punctuation section class begin java"><span>{</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="storage type java"><span>String</span></span><span>&nbsp;name</span><span class="punctuation terminator java"><span>;</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="punctuation section class end java"><span>}</span></span></span></span></div></pre>
<p>ViewModel:</p>
<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="meta class java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta class identifier java"><span class="storage modifier java"><span>class</span></span><span>&nbsp;</span><span class="entity name type class java"><span>DreamVm</span></span></span><span>&nbsp;</span><span class="meta definition class inherited classes java"><span class="storage modifier extends java"><span>extends</span></span><span>&nbsp;</span><span class="entity other inherited-class java"><span>BaseObservable</span></span></span><span class="meta class body java"><span class="punctuation section class begin java"><span>{</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier java"><span>private</span></span><span>&nbsp;</span><span class="storage type java"><span>String</span></span><span>&nbsp;name</span><span class="punctuation terminator java"><span>;</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type annotation java"><span>@Bindable</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta method return-type java"><span class="storage type java"><span>String</span></span><span>&nbsp;</span></span><span class="meta method identifier java"><span class="entity name function java"><span>getName</span></span><span>(</span><span>)</span></span><span>&nbsp;</span><span class="punctuation section method begin java"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control java"><span>return</span></span><span>&nbsp;name</span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation section method end java"><span>}</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta method return-type java"><span class="storage type primitive array java"><span>void</span></span><span>&nbsp;</span></span><span class="meta method identifier java"><span class="entity name function java"><span>setName</span></span><span>(</span><span class="storage type java"><span>String</span></span><span>&nbsp;</span><span class="variable parameter java"><span>name</span></span><span>)</span></span><span>&nbsp;</span><span class="punctuation section method begin java"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable language this java"><span>this</span></span><span class="keyword operator dereference java"><span>.</span></span><span>name&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;name</span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method-call java"><span class="meta method java"><span>notifyPropertyChanged</span></span><span class="punctuation definition method-parameters begin java"><span>(</span></span><span class="storage type java"><span>com.kale.dream</span><span class="keyword operator dereference java"><span>.</span></span><span>BR</span></span><span class="keyword operator dereference java"><span>.</span></span><span>name</span><span class="punctuation definition method-parameters end java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation section method end java"><span>}</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type annotation java"><span>@Bindable</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta method return-type java"><span class="storage type primitive array java"><span>int</span></span><span>&nbsp;</span></span><span class="meta method identifier java"><span class="entity name function java"><span>getViz</span></span><span>(</span><span>)</span></span><span>&nbsp;</span><span class="punctuation section method begin java"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control java"><span>switch</span></span><span>&nbsp;</span><span>(</span><span>name</span><span>)</span><span>&nbsp;</span><span class="punctuation section block begin java"><span>{</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control java"><span>case</span></span><span>&nbsp;</span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>jack</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="keyword control ternary java"><span>:</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control java"><span>return</span></span><span>&nbsp;</span><span class="storage type java"><span>View</span></span><span class="constant other java"><span class="keyword operator dereference java"><span>.</span></span><span>VISIBLE</span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control java"><span>case</span></span><span>&nbsp;</span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>tony</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="keyword control ternary java"><span>:</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control java"><span>return</span></span><span>&nbsp;</span><span class="storage type java"><span>View</span></span><span class="constant other java"><span class="keyword operator dereference java"><span>.</span></span><span>INVISIBLE</span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control java"><span>default</span></span><span class="keyword control ternary java"><span>:</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control java"><span>return</span></span><span>&nbsp;</span><span class="storage type java"><span>View</span></span><span class="constant other java"><span class="keyword operator dereference java"><span>.</span></span><span>GONE</span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section block end java"><span>}</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation section method end java"><span>}</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block java"><span class="punctuation definition comment java"><span>/*</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="comment block java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*事务操作,这部分处理其实不应该放在这里</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="comment block java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition comment java"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta method return-type java"><span class="storage type primitive array java"><span>void</span></span><span>&nbsp;</span></span><span class="meta method identifier java"><span class="entity name function java"><span>load</span></span><span>(</span><span>)</span></span><span>&nbsp;</span><span class="punctuation section method begin java"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type java"><span>HttpUtil</span></span><span class="keyword operator dereference java"><span>.</span></span><span class="meta method-call java"><span class="meta method java"><span>doGet</span></span><span class="punctuation definition method-parameters begin java"><span>(</span></span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span class="markup underline link http hyperlink"><span>http://www.kalexxxxxx</span></span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="punctuation definition seperator parameter java"><span>,</span></span><span>&nbsp;</span><span class="keyword control new java"><span>new</span></span><span>&nbsp;</span><span class="storage type java"><span>HttpUtil</span></span><span>.</span><span class="storage type generic java"><span>HttpCallback&lt;</span><span class="storage type java"><span>UserInfo02</span></span><span>&gt;</span></span><span>(</span><span>)</span><span>&nbsp;</span><span class="meta inner-class java"><span class="punctuation section inner-class begin java"><span>{</span></span></span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span class="meta method-call java"><span class="meta inner-class java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type annotation java"><span>@Override</span></span></span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span class="meta method-call java"><span class="meta inner-class java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta method return-type java"><span class="storage type primitive array java"><span>void</span></span><span>&nbsp;</span></span><span class="meta method identifier java"><span class="entity name function java"><span>onSuccess</span></span><span>(</span><span class="storage type java"><span>UserInfo02</span></span><span>&nbsp;</span><span class="variable parameter java"><span>info</span></span><span>)</span></span><span>&nbsp;</span><span class="punctuation section method begin java"><span>{</span></span></span></span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span class="meta method-call java"><span class="meta inner-class java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method-call java"><span class="meta method java"><span>setName</span></span><span class="punctuation definition method-parameters begin java"><span>(</span></span><span>info</span><span class="keyword operator dereference java"><span>.</span></span><span>name</span><span class="punctuation definition method-parameters end java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span class="meta method-call java"><span class="meta inner-class java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation section method end java"><span>}</span></span></span></span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span class="meta method-call java"><span class="meta inner-class java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section inner-class end java"><span>}</span></span></span><span class="punctuation definition method-parameters end java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation section method end java"><span>}</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="punctuation section class end java"><span>}</span></span></span></span></div></pre>
<p>布局文件：</p>
<pre class="editor-colors lang-XML"><div class="line"><span class="text plain null-grammar"><span>//&nbsp;将之前的userinfo换为vm来绑定</span></span></div><div class="line"><span class="text plain null-grammar"><span>&lt;TextView</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;android:layout_width=&quot;wrap_content&quot;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;android:layout_height=&quot;wrap_content&quot;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;android:text=&quot;@{vm.name}&quot;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;android:visibility=&quot;@{vm.viz}&quot;</span></span></div><div class="line"><span class="text plain null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;/&gt;</span></span></div></pre>
<p>Activity：</p>
<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="meta class java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta class identifier java"><span class="storage modifier java"><span>class</span></span><span>&nbsp;</span><span class="entity name type class java"><span>DreamAct</span></span></span><span>&nbsp;</span><span class="meta definition class inherited classes java"><span class="storage modifier extends java"><span>extends</span></span><span>&nbsp;</span><span class="entity other inherited-class java"><span>AppCompatActivity</span></span><span>&nbsp;</span></span><span class="meta class body java"><span class="punctuation section class begin java"><span>{</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type annotation java"><span>@Override</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method java"><span class="storage modifier java"><span>protected</span></span><span>&nbsp;</span><span class="meta method return-type java"><span class="storage type primitive array java"><span>void</span></span><span>&nbsp;</span></span><span class="meta method identifier java"><span class="entity name function java"><span>onCreate</span></span><span>(</span><span class="storage type java"><span>Bundle</span></span><span>&nbsp;</span><span class="variable parameter java"><span>savedInstanceState</span></span><span>)</span></span><span>&nbsp;</span><span class="punctuation section method begin java"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier java"><span>final</span></span><span>&nbsp;</span><span class="storage type java"><span>Dream02Binding</span></span><span>&nbsp;binding&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="storage type java"><span>DataBindingUtil</span></span><span class="keyword operator dereference java"><span>.</span></span><span class="meta method-call java"><span class="meta method java"><span>setContentView</span></span><span class="punctuation definition method-parameters begin java"><span>(</span></span><span class="variable language this java"><span>this</span></span><span class="punctuation definition seperator parameter java"><span>,</span></span><span>&nbsp;</span><span class="storage type java"><span>R</span></span><span class="keyword operator dereference java"><span>.</span></span><span>layout</span><span class="keyword operator dereference java"><span>.</span></span><span>dream_02</span><span class="punctuation definition method-parameters end java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type java"><span>DreamVmp02</span></span><span>&nbsp;viewModel&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="keyword control new java"><span>new</span></span><span>&nbsp;</span><span class="storage type java"><span>DreamVmp02</span></span><span>(</span><span>)</span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binding</span><span class="keyword operator dereference java"><span>.</span></span><span class="meta method-call java"><span class="meta method java"><span>setVm</span></span><span class="punctuation definition method-parameters begin java"><span>(</span></span><span>viewModel</span><span class="punctuation definition method-parameters end java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;viewModel</span><span class="keyword operator dereference java"><span>.</span></span><span class="meta method-call java"><span class="meta method java"><span>load</span></span><span class="punctuation definition method-parameters begin java"><span>(</span></span><span class="punctuation definition method-parameters end java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span><span>&nbsp;</span><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;加载网络请求</span><span>&nbsp;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation section method end java"><span>}</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="punctuation section class end java"><span>}</span></span></span></span></div></pre>
<p>这么做就没什么大问题了，VM 处理了逻辑，Model 变成纯粹的类。而且也不用在布局文件中写什么
Java 代码了，只要绑定 VM 的字段就行了。View 相关的 Java 代码都在 Activity 中完成，如果
View 的逻辑出错了直接进入 Activity 中定位就好了。</p>
    </div>